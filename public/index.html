<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slotify — Appointment Scheduling System</title>
    <meta name="description" content="Slotify — Book, manage, and track appointments with ease">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Ambient Glow Orbs -->
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>

    <!-- ==================== AUTH SCREEN ==================== -->
    <div id="authScreen" class="screen active">
        <div class="auth-wrapper">
            <div class="auth-left">
                <div class="auth-brand">
                    <div class="brand-icon"><i data-lucide="calendar-clock"></i></div>
                    <h1>Slotify</h1>
                    <p>Intelligent appointment management for modern healthcare</p>
                </div>
                <div class="auth-features">
                    <div class="auth-feature"><i data-lucide="shield-check"></i><span>Secure & HIPAA-ready</span></div>
                    <div class="auth-feature"><i data-lucide="zap"></i><span>Real-time scheduling</span></div>
                    <div class="auth-feature"><i data-lucide="bot"></i><span>AI booking assistant</span></div>
                    <div class="auth-feature"><i data-lucide="bar-chart-3"></i><span>Analytics dashboard</span></div>
                </div>
            </div>
            <div class="auth-right">
                <div class="auth-card">
                    <div class="auth-tabs">
                        <button class="auth-tab active" onclick="switchAuthTab('login')">Sign In</button>
                        <button class="auth-tab" onclick="switchAuthTab('register')">Create Account</button>
                    </div>

                    <!-- Login -->
                    <form id="loginForm" class="auth-form" onsubmit="handleLogin(event)">
                        <div class="input-group">
                            <label>Email Address</label>
                            <div class="input-wrapper">
                                <i data-lucide="mail"></i>
                                <input type="email" id="loginEmail" placeholder="you@example.com" required>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Password</label>
                            <div class="input-wrapper">
                                <i data-lucide="lock"></i>
                                <input type="password" id="loginPassword" placeholder="Enter your password" required>
                                <button type="button" class="password-toggle"
                                    onclick="togglePassword('loginPassword', this)">
                                    <i data-lucide="eye"></i>
                                </button>
                            </div>
                        </div>
                </div>

                <div class="auth-separator">
                    <span>OR</span>
                </div>

                <a href="/api/auth/google" class="btn btn-outline btn-full google-btn">
                    <i data-lucide="scan-face"></i>
                    <!-- Using scan-face as a proxy for Google icon since lucide doesn't have brand icons -->
                    <span>Continue with Google</span>
                </a>

                <div style="margin-top: 1rem;"></div>
                <button type="submit" class="btn btn-primary btn-full" id="loginBtn">
                    <span>Sign In</span>
                    <i data-lucide="arrow-right"></i>
                </button>
                </form>

                <!-- Register -->
                <form id="registerForm" class="auth-form hidden" onsubmit="handleRegister(event)">
                    <div class="input-group">
                        <label>Full Name</label>
                        <div class="input-wrapper">
                            <i data-lucide="user"></i>
                            <input type="text" id="regName" placeholder="John Doe" required>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Email Address</label>
                        <div class="input-wrapper">
                            <i data-lucide="mail"></i>
                            <input type="email" id="regEmail" placeholder="you@example.com" required>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Password</label>
                        <div class="input-wrapper">
                            <i data-lucide="lock"></i>
                            <input type="password" id="regPassword" placeholder="Min 6 chars, 1 number" required>
                            <button type="button" class="password-toggle" onclick="togglePassword('regPassword', this)">
                                <i data-lucide="eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Role</label>
                        <div class="input-wrapper">
                            <i data-lucide="user-cog"></i>
                            <select id="regRole" onchange="toggleProviderFields()">
                                <option value="user">Patient</option>
                                <option value="provider">Service Provider</option>
                                <option value="admin">Administrator</option>
                            </select>
                        </div>
                    </div>
                    <div id="providerFields" class="hidden">
                        <div class="input-group">
                            <label>Specialization</label>
                            <div class="input-wrapper">
                                <i data-lucide="stethoscope"></i>
                                <input type="text" id="regSpecialization" placeholder="e.g. Dentist">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Phone</label>
                            <div class="input-wrapper">
                                <i data-lucide="phone"></i>
                                <input type="tel" id="regPhone" placeholder="9876543210">
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full" id="registerBtn">
                        <span>Create Account</span>
                        <i data-lucide="arrow-right"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>
    </div>

    <!-- ==================== MAIN APP ==================== -->
    <div id="appScreen" class="screen hidden">
        <div class="sidebar-overlay" onclick="toggleMobileMenu()"></div>

        <!-- Navbar -->
        <nav class="navbar">
            <button class="nav-icon-btn mobile-menu-btn hidden-d" onclick="toggleMobileMenu()">
                <i data-lucide="menu"></i>
            </button>
            <div class="nav-brand">
                <i data-lucide="calendar-clock"></i>
                <span>Slotify</span>
            </div>
            <div class="nav-search">
                <i data-lucide="search"></i>
                <input type="text" placeholder="Search appointments, providers..." id="globalSearch"
                    oninput="handleSearchInput()" onfocus="handleSearchInput()" autocomplete="off">
                <div id="searchResults" class="search-dropdown hidden"></div>
            </div>
            <div class="nav-actions">
                <button class="nav-icon-btn" onclick="showView('chatView')" title="AI Assistant">
                    <i data-lucide="bot"></i>
                </button>
                <button class="nav-icon-btn" id="notifBtn" title="Notifications">
                    <i data-lucide="bell"></i>
                    <span class="notif-dot"></span>
                </button>
                <div class="nav-user" onclick="toggleUserMenu()">
                    <div class="avatar" id="userAvatar">U</div>
                    <div class="nav-user-info">
                        <span id="navUserName" class="nav-username">User</span>
                        <span id="navUserRole" class="nav-userrole">Patient</span>
                    </div>
                    <i data-lucide="chevron-down" class="nav-chevron"></i>
                </div>
                <div id="userMenu" class="user-menu hidden">
                    <div class="user-menu-item" onclick="showView('profileView')">
                        <i data-lucide="user"></i><span>Profile</span>
                    </div>
                    <div class="user-menu-divider"></div>
                    <div class="user-menu-item danger" onclick="logout()">
                        <i data-lucide="log-out"></i><span>Logout</span>
                    </div>
                </div>
            </div>
        </nav>

        <div class="app-body">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-nav" id="sidebarNav"></div>
                <div class="sidebar-footer">
                    <div class="sidebar-item" onclick="logout()">
                        <i data-lucide="log-out"></i>
                        <span>Logout</span>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">

                <!-- Dashboard View -->
                <div id="dashboardView" class="view active">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Dashboard</h1>
                            <p class="page-subtitle" id="welcomeMsg">Welcome back!</p>
                        </div>
                    </div>
                    <div class="stats-row" id="statsRow"></div>
                    <div class="section-header">
                        <h2>Recent Appointments</h2>
                    </div>
                    <div id="recentAppointments" class="appointments-list"></div>
                    <div class="section-header">
                        <h2 id="directoryTitle">Directory</h2>
                    </div>
                    <div id="directoryList" class="slots-grid"></div>
                </div>

                <!-- Available Slots View -->
                <div id="slotsView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Book Appointment</h1>
                            <p class="page-subtitle">Find and book available time slots</p>
                        </div>
                        <div class="header-actions">
                            <div class="input-wrapper compact">
                                <i data-lucide="calendar"></i>
                                <input type="date" id="filterDate" onchange="loadSlots()">
                            </div>
                            <button class="btn btn-ghost" onclick="clearFilter()">
                                <i data-lucide="x"></i> Clear
                            </button>
                        </div>
                    </div>
                    <div id="slotsList" class="slots-grid"></div>
                    <div id="noSlots" class="empty-state hidden">
                        <i data-lucide="calendar-x"></i>
                        <h3>No Available Slots</h3>
                        <p>Try selecting a different date or check back later</p>
                    </div>
                </div>

                <!-- My Appointments View -->
                <div id="appointmentsView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">My Appointments</h1>
                            <p class="page-subtitle">View and manage your bookings</p>
                        </div>
                    </div>
                    <div id="appointmentsList" class="appointments-list"></div>
                    <div id="noAppointments" class="empty-state hidden">
                        <i data-lucide="inbox"></i>
                        <h3>No Appointments</h3>
                        <p>You haven't booked any appointments yet</p>
                        <button class="btn btn-primary" onclick="showView('slotsView')">
                            <i data-lucide="plus"></i> Book Now
                        </button>
                    </div>
                </div>

                <!-- Waitlist View -->
                <div id="waitlistView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Waitlist</h1>
                            <p class="page-subtitle">Track your position in the queue</p>
                        </div>
                    </div>
                    <div id="waitlistList" class="appointments-list"></div>
                    <div id="noWaitlist" class="empty-state hidden">
                        <i data-lucide="list"></i>
                        <h3>Not on any waitlists</h3>
                        <p>When a slot is full, you can join its waitlist to get notified</p>
                    </div>
                </div>

                <!-- Wait Time View -->
                <div id="waitTimeView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Wait Time Estimate</h1>
                            <p class="page-subtitle">Check estimated wait times for providers</p>
                        </div>
                    </div>
                    <div id="waitTimeContent" class="wait-time-section"></div>
                </div>

                <!-- Provider: Manage Slots -->
                <div id="manageSlotsView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Manage Slots</h1>
                            <p class="page-subtitle">Create and manage your available time slots</p>
                        </div>
                        <button class="btn btn-primary" onclick="openCreateSlotModal()">
                            <i data-lucide="plus"></i> Create Slot
                        </button>
                    </div>
                    <div id="mySlotsList" class="slots-grid"></div>
                </div>

                <!-- Provider: Confirmations -->
                <div id="confirmationsView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Pending Confirmations</h1>
                            <p class="page-subtitle">Review and confirm patient bookings</p>
                        </div>
                    </div>
                    <div id="pendingList" class="appointments-list"></div>
                </div>

                <!-- Provider: Analytics Dashboard -->
                <div id="analyticsDashView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Analytics</h1>
                            <p class="page-subtitle">Overview of your practice performance</p>
                        </div>
                    </div>
                    <div class="stats-row" id="providerStats"></div>
                    <div class="section-header">
                        <h2>Upcoming Appointments</h2>
                    </div>
                    <div id="providerUpcoming" class="table-wrapper"></div>
                </div>

                <!-- Admin View -->
                <div id="adminView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Admin Panel</h1>
                            <p class="page-subtitle">System-wide appointment overview</p>
                        </div>
                    </div>
                    <div class="stats-row" id="adminStats"></div>
                    <div class="section-header">
                        <h2>All Appointments</h2>
                    </div>
                    <div id="allAppointmentsList" class="table-wrapper"></div>
                </div>

                <!-- Chatbot -->
                <div id="chatView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">AI Booking Assistant</h1>
                            <p class="page-subtitle">Chat with our intelligent assistant to manage your appointments</p>
                        </div>
                    </div>
                    <div class="chat-window">
                        <div id="chatMessages" class="chat-messages">
                            <div class="chat-msg bot">
                                <div class="chat-avatar bot-avatar"><i data-lucide="bot"></i></div>
                                <div class="chat-content">
                                    <p>Hello! I'm your scheduling assistant. Type <strong>help</strong> to see what I
                                        can do, or just tell me what you need!</p>
                                </div>
                            </div>
                        </div>
                        <form class="chat-form" onsubmit="sendChat(event)">
                            <input type="text" id="chatInput" placeholder="Type a message..." autocomplete="off">
                            <button type="submit" class="btn btn-primary chat-send">
                                <i data-lucide="send"></i>
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Timeline -->
                <div id="timelineView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Appointment Timeline</h1>
                            <p class="page-subtitle">Full status history for your appointment</p>
                        </div>
                        <button class="btn btn-ghost" onclick="showView('appointmentsView')">
                            <i data-lucide="arrow-left"></i> Back
                        </button>
                    </div>
                    <div id="timelineContent" class="timeline-section"></div>
                </div>

                <!-- Profile -->
                <div id="profileView" class="view hidden">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Profile</h1>
                            <p class="page-subtitle">Your account information</p>
                        </div>
                    </div>
                    <div id="profileContent" class="profile-section"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal -->
    <div id="modalOverlay" class="modal-overlay hidden" onclick="closeModal()">
        <div class="modal-card" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h3 id="modalTitle"></h3>
                <button class="modal-x" onclick="closeModal()"><i data-lucide="x"></i></button>
            </div>
            <div id="modalBody" class="modal-content"></div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-wrapper"></div>

    <script src="app.js"></script>
</body>

</html>